language: c
sudo: required
os: linux
dist: trusty

before_install:
  - sudo apt-get -qq update
  - sudo apt-get install -y git autoconf libtool make gcc libtool libfuse-dev liblzma-dev libglib2.0-dev libssl-dev libinotifytools0-dev 
  # libtool-bin might be required in newer distributions but is not available in precise


script:
  - bash -ex install-build-deps.sh
  - bash -ex build.sh
  - bash -ex build-appimage.sh
  - curl --upload-file ./*.AppImage https://transfer.sh/appimagetool
  - curl --upload-file ./build/validate https://transfer.sh/validate
  - curl --upload-file ./build/appimaged https://transfer.sh/appimaged

notifications:
  irc:
    channels:
      - "chat.freenode.net#AppImage"
    on_success: always  # options: [always|never|change] default: always
    on_failure: always  # options: [always|never|change] default: always
    on_start: never     # options: [always|never|change] default: always
  webhooks:
    urls:
      - https://webhooks.gitter.im/e/4bf20518805a55998cc2
    on_success: always  # options: [always|never|change] default: always
    on_failure: always  # options: [always|never|change] default: always
    on_start: never     # options: [always|never|change] default: always
